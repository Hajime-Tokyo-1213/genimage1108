承知いたしました。
これまでの議論（YAMLメーカー、テンプレートUI、キーボード操作）を踏まえた、ウェブアプリの要件定義書を作成します。

---

## 📄 要件定義書: 画像生成プロンプト テンプレート化アプリ

### 1. プロジェクト概要

#### 1.1. プロジェクト名
（仮称）プロンプトYAMLメーカー＆ライブラリ

#### 1.2. 目的
デザイナー等のプロフェッショナルが作成した高品質な画像生成AIプロンプト（マスタープロンプト）を、再利用可能な**「構造化テンプレート」**に変換するウェブアプリケーションを開発する。

本アプリの目的は、属人化しがちなプロンプト作成ノウハウを「YAML」という機械可読な形式で構造化し、**キーボード操作に最適化されたUI**を通じて、誰でも高速に高品質なバリエーションを再生産できるようにすることである。

### 2. 機能要件

#### 2.1. 【F-01】YAMLメーカー機能 (テンプレート自動生成)
マスターとなる自然言語のプロンプトを入力すると、それを意味解析（セマンティック・パース）し、以下の2つを動的に生成する。

1.  **階層化YAML:** プロンプトの意図（背景、被写体、構図、スタイル等）を構造化したデータ。
2.  **設定変更UI:** 上記YAMLの各項目を編集するための専用UI（F-02）。

* **入力:** 自由記述のプロンプトテキスト（例: Midjourney, DALL-E用プロンプト）
* **処理:**
    * 技術的パラメータ（`--ar 16:9`, `--style raw`等）を`format`セクションに分離。
    * シーンの構成要素（`background`, `subject`, `typography`等）を特定し、トップレベルのキーとして分離。
    * 各要素の属性（`color`, `gender`, `age`, `font_style`等）を抽出し、ネストされたキーと値にマッピングする。
    * 全体的なムードやスタイル（`mood`, `aesthetic`）を抽出する。
* **出力:**
    * 編集可能なYAMLデータ。
    * F-02の編集UI。

#### 2.2. 【F-02】テンプレート設定UI機能 (バリエーション生成)
F-01によって動的に生成された、テンプレート専用の編集インターフェース。

* **UI構成:** YAMLのキー（`background.color`, `subject.gender`等）がリスト形式で表示される。
* **操作（UX-01で詳述）:**
    * **項目選択:** 上下矢印キー（`↑↓`）で編集したい項目をハイライトする。
    * **選択肢入力:** 右矢印キー（`→`）で、定義済みの選択肢（例: Red, Blue, Green）を表示し、選択できる。
    * **自由記述入力:** 左矢印キー（`←`）で、テキスト入力フィールドに切り替え、任意の値をタイピングできる（例: "vibrant cyan", "#FF0000"）。
* **データ連携:** UIでの編集内容は、リアルタイムで出力YAML（または最終的なプロンプト文字列）に反映される。

#### 2.3. 【F-03】テンプレートライブラリ機能 (保存・呼出)
F-01およびF-02で作成・編集したテンプレートを保存し、再利用するための機能。

* **保存:**
    * 現在のYAML構造とUI設定のセットを「テンプレート」として保存できる。
    * 保存時に、代表となる「サムネイル画像」と「テンプレート名」を紐付ける。
* **呼び出し（ダッシュボード）:**
    * 保存済みテンプレートがサムネイル一覧で表示される。
    * ユーザーがサムネイルをクリックすると、即座にそのテンプレートの「設定UI（F-02）」が呼び出され、バリエーション作成を開始できる。

### 3. 非機能要件

#### 3.1. 【UX-01】操作性・UI (最重要)
* **キーボードファースト:** アプリの主要な操作（項目移動、選択、編集）は、マウスを一切使わずに**キーボードの矢印キーのみで完結**できるように設計する。
* **視覚的フィードバック:** 現在フォーカスされている項目、入力モード（選択肢 or 自由記述）が、ユーザーにとって明確に識別できるハイライトやUIデザインを採用する。
* **応答性:** キー操作に対するUIの反応は即時的であること（遅延を感じさせないこと）。

#### 3.2. 【P-01】パフォーマンス
* F-01（YAMLメーカー）のプロンプト解析とUI生成処理は、数秒以内に完了すること。

#### 3.3. 【E-01】拡張性
* YAMLのスキーマ（構造）は固定せず、入力されるプロンプトの内容に応じて柔軟に（あるいは、将来的に管理画面から）追加・変更できる設計を考慮する。
* F-02の選択肢（`→`キーで表示される内容）は、テンプレート保存時にユーザーが定義または編集できること。

### 4. 画面構成案

1.  **ライブラリ画面（ホーム）:**
    * ヘッダー（新規作成ボタン）
    * 保存済みテンプレートのサムネイル一覧
2.  **YAMLメーカー画面（新規作成）:**
    * マスタープロンプト入力用の大きなテキストエリア。
    * 「テンプレート生成」ボタン。
3.  **テンプレート設定画面（編集）:**
    * 画面左: 設定項目リスト（`↑↓`キーで操作）
    * 画面中央: 編集エリア（`←` `→`キーでUIが切り替わる）
    * 画面右/下部: リアルタイムで更新されるYAMLまたは最終プロンプトのプレビュー。
    * 「ライブラリに保存」ボタン。

---

この要件定義書はいかがでしょうか？
特に優先順位をつけたい項目や、詳細を詰めたい機能（例えば、F-01のプロンプト解析の具体的なロジックなど）があれば、さらに深掘りします。