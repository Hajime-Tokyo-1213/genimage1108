# ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ã®ç¢ºèªæ–¹æ³•

## ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèª

ã‚¢ãƒ—ãƒªã‚’é–‹ã„ãŸçŠ¶æ…‹ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆF12ï¼‰ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œï¼š

```javascript
// 1. Supabaseã®ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±ã‚’ç¢ºèª
const session = JSON.parse(localStorage.getItem('sb_session') || '{}');
console.log('ğŸ” ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±:', {
  hasSession: !!session?.access_token,
  expiresAt: session?.expires_at ? new Date(session.expires_at * 1000).toLocaleString('ja-JP') : 'ãªã—',
  userId: session?.user?.id,
  email: session?.user?.email,
  username: session?.user?.user_metadata?.username
});

// 2. ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æœ‰åŠ¹æœŸé™ã‚’ç¢ºèª
if (session?.expires_at) {
  const expiresAt = new Date(session.expires_at * 1000);
  const now = new Date();
  const isExpired = expiresAt < now;
  console.log('â° ã‚»ãƒƒã‚·ãƒ§ãƒ³æœ‰åŠ¹æœŸé™:', {
    æœ‰åŠ¹æœŸé™: expiresAt.toLocaleString('ja-JP'),
    ç¾åœ¨æ™‚åˆ»: now.toLocaleString('ja-JP'),
    æœ‰åŠ¹: !isExpired,
    æ®‹ã‚Šæ™‚é–“: isExpired ? 'æœŸé™åˆ‡ã‚Œ' : `${Math.floor((expiresAt - now) / 1000 / 60)}åˆ†`
  });
}
```

## çŠ¶æ…‹ã®åˆ¤æ–­

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒå­˜åœ¨ã—ã€æœ‰åŠ¹æœŸé™å†…
- **çŠ¶æ…‹**: æ­£å¸¸ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹
- **Last signed inãŒæ›´æ–°ã•ã‚Œãªã„ç†ç”±**: æ—¢å­˜ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã‚‹ã ã‘ï¼ˆæ–°ã—ã„ãƒ­ã‚°ã‚¤ãƒ³ã§ã¯ãªã„ï¼‰
- **å¯¾å‡¦**: å•é¡Œãªã—ã€‚æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒå­˜åœ¨ã™ã‚‹ãŒã€æœŸé™åˆ‡ã‚Œ
- **çŠ¶æ…‹**: ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæœŸé™åˆ‡ã‚Œã¦ã„ã‚‹ãŒã€ã‚¢ãƒ—ãƒªãŒæ°—ã¥ã„ã¦ã„ãªã„
- **å¯¾å‡¦**: ãƒ­ã‚°ã‚¢ã‚¦ãƒˆâ†’ãƒ­ã‚°ã‚¤ãƒ³ã—ç›´ã™

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒå­˜åœ¨ã—ãªã„
- **çŠ¶æ…‹**: ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„
- **å¯¾å‡¦**: ãƒ­ã‚°ã‚¤ãƒ³ã—ç›´ã™

## å®Ÿéš›ã®ãƒ­ã‚°ã‚¤ãƒ³ã‚’è©¦ã™

`Last signed in`ã‚’æ›´æ–°ã™ã‚‹ã«ã¯ã€å®Ÿéš›ã«ãƒ­ã‚°ã‚¤ãƒ³æ“ä½œã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

1. **ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ**
   - ã‚¢ãƒ—ãƒªã®ã€Œãƒ­ã‚°ã‚¢ã‚¦ãƒˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

2. **ãƒ­ã‚°ã‚¤ãƒ³**
   - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›
   - ã€Œãƒ­ã‚°ã‚¤ãƒ³ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

3. **ç¢ºèª**
   - Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§`Last signed in`ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

## æ³¨æ„ç‚¹

- `Updated at`ãŒæ›´æ–°ã•ã‚Œã‚‹ã®ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚„ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒå¤‰æ›´ã•ã‚ŒãŸæ™‚ã§ã™
- `Last signed in`ãŒæ›´æ–°ã•ã‚Œã‚‹ã®ã¯ã€`signInWithPassword`ãŒå®Ÿè¡Œã•ã‚ŒãŸæ™‚ã ã‘ã§ã™
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ï¼ˆ`refreshSession`ï¼‰ã§ã¯`Last signed in`ã¯æ›´æ–°ã•ã‚Œã¾ã›ã‚“

